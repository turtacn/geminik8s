# geminik8s

<img src="logo.png" alt="geminik8s Logo" width="200" height="200">

[![æ„å»ºçŠ¶æ€](https://img.shields.io/github/actions/workflow/status/turtacn/geminik8s/ci.yml?branch=main)](https://github.com/turtacn/geminik8s/actions)
[![è®¸å¯è¯: Apache 2.0](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![Go ç‰ˆæœ¬](https://img.shields.io/github/go-mod/go-version/turtacn/geminik8s)](https://golang.org/)
[![å‘å¸ƒç‰ˆæœ¬](https://img.shields.io/github/v/release/turtacn/geminik8s)](https://github.com/turtacn/geminik8s/releases)

> **é¢å‘æˆæœ¬ä¼˜åŒ–éƒ¨ç½²çš„åŒèŠ‚ç‚¹é«˜å¯ç”¨ Kubernetes è§£å†³æ–¹æ¡ˆ**

[English README](./README.md) | [æ¶æ„æ–‡æ¡£](./docs/architecture.md)

## ğŸš€ é¡¹ç›®ä½¿å‘½

geminik8s é€šè¿‡æä¾›æˆæœ¬æ•ˆç›Šæé«˜çš„åŒèŠ‚ç‚¹é«˜å¯ç”¨è§£å†³æ–¹æ¡ˆï¼Œé©æ–°äº† Kubernetes éƒ¨ç½²æ¨¡å¼ã€‚ç›¸æ¯”ä¼ ç»Ÿä¸‰èŠ‚ç‚¹é›†ç¾¤ï¼ŒåŸºç¡€è®¾æ–½æˆæœ¬é™ä½é«˜è¾¾ 33%ï¼ŒåŒæ—¶ä¿æŒä¼ä¸šçº§å¯é æ€§å’Œæ€§èƒ½ã€‚

## ğŸ¯ ä¸ºä»€ä¹ˆé€‰æ‹© geminik8sï¼Ÿ

**ä¼ ç»Ÿ Kubernetes é«˜å¯ç”¨çš„ç—›ç‚¹ï¼š**
- ğŸ”¸ **é«˜æˆæœ¬é—¨æ§›**: ä¼ ç»Ÿé«˜å¯ç”¨å›  etcd æ³•å®šäººæ•°è¦æ±‚æœ€å°‘éœ€è¦ 3 ä¸ªèŠ‚ç‚¹
- ğŸ”¸ **èµ„æºæµªè´¹**: ä¸ºåŸºæœ¬é«˜å¯ç”¨éœ€æ±‚è¿›è¡Œè¿‡åº¦é…ç½®  
- ğŸ”¸ **å¤æ‚æ€§å¼€é”€**: ç®¡ç† etcd é›†ç¾¤å¢åŠ è¿ç»´è´Ÿæ‹…
- ğŸ”¸ **ä¾›åº”å•†é”å®š**: å­˜å‚¨åç«¯é€‰æ‹©å—é™

**geminik8s çš„ä¼˜åŠ¿ï¼š**
- âœ… **æˆæœ¬ä¼˜åŒ–**: ç¡¬ä»¶ã€ç”µåŠ›å’Œè¿ç»´æˆæœ¬é™ä½ 33%
- âœ… **æ¶æ„ç®€åŒ–**: PostgreSQL + Kine æ›¿ä»£å¤æ‚çš„ etcd ç®¡ç†
- âœ… **ç”Ÿäº§å°±ç»ª**: ç»è¿‡å®æˆ˜æ£€éªŒçš„æˆæœ¬æ•æ„Ÿéƒ¨ç½²è§£å†³æ–¹æ¡ˆ
- âœ… **Kubernetes åŸç”Ÿ**: ä¸æ ‡å‡† K8s/K3s å‘è¡Œç‰ˆå®Œå…¨å…¼å®¹
- âœ… **è‡ªåŠ¨æ•…éšœè½¬ç§»**: æ™ºèƒ½ä¸»èŠ‚ç‚¹é€‰ä¸¾å’Œæ— ç¼èŠ‚ç‚¹æå‡
- âœ… **é›¶åœæœºå‡çº§**: A/B åˆ†åŒºç­–ç•¥æ”¯æŒè‡ªåŠ¨å›æ»š

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ—ï¸ æ¶æ„ä¸åŸºç¡€è®¾æ–½
- **åŒèŠ‚ç‚¹é«˜å¯ç”¨**: ä¼ ç»Ÿ 3 èŠ‚ç‚¹é›†ç¾¤çš„æˆæœ¬æ•ˆç›Šæ›¿ä»£æ–¹æ¡ˆ
- **PostgreSQL åç«¯**: åˆ©ç”¨å¼ºå¤§çš„ SQL æ•°æ®åº“æ›¿ä»£ etcd
- **Kine é›†æˆ**: æ— ç¼çš„ etcd åˆ° SQL è½¬æ¢å±‚
- **A/B åˆ†åŒº**: ä¸å¯å˜ OS é•œåƒæ”¯æŒè‡ªåŠ¨å›æ»š

### ğŸ”„ ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **æ™ºèƒ½ç¼–æ’**: è‡ªåŠ¨åŒ–ä¸»èŠ‚ç‚¹é€‰ä¸¾å’Œæ•…éšœè½¬ç§»
- **å¥åº·ç›‘æ§**: å…¨é¢çš„å­˜æ´»æ£€æŸ¥å’Œæ¢å¤æœºåˆ¶
- **å‡çº§è‡ªåŠ¨åŒ–**: æ”¯æŒå›æ»šçš„é›¶åœæœºé›†ç¾¤å‡çº§
- **èŠ‚ç‚¹æ›¿æ¢**: æ•…éšœèŠ‚ç‚¹çš„æ— ç¼æ›¿æ¢

### ğŸ› ï¸ å¼€å‘è€…ä½“éªŒ
- **CLI ä¼˜å…ˆè®¾è®¡**: åŸºäº Cobra çš„ç›´è§‚å‘½ä»¤è¡Œç•Œé¢
- **æ’ä»¶æ¶æ„**: å¯æ‰©å±•çš„è‡ªå®šä¹‰åŠŸèƒ½ç³»ç»Ÿ
- **é…ç½®å³ä»£ç **: å£°æ˜å¼é›†ç¾¤é…ç½®ç®¡ç†
- **å¤šå¹³å°æ”¯æŒ**: è·¨å¹³å°äºŒè¿›åˆ¶åˆ†å‘

### ğŸ”’ ä¼ä¸šåŠŸèƒ½
- **ç”Ÿäº§çº§åˆ«**: ä¸“ä¸ºä¼ä¸šå¯é æ€§è¦æ±‚è®¾è®¡
- **å¯è§‚æµ‹æ€§**: å†…ç½®ç›‘æ§å’Œæ—¥å¿—è®°å½•èƒ½åŠ›
- **å®‰å…¨æ€§**: æ ‡å‡† Kubernetes RBAC å’Œå®‰å…¨ç­–ç•¥
- **å¤‡ä»½æ¢å¤**: æ•°æ®ä¿æŠ¤çš„è‡ªåŠ¨åŒ–å¤‡ä»½ç­–ç•¥

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

ä½¿ç”¨ Go å®‰è£… geminik8sï¼š

```bash
go install github.com/turtacn/geminik8s/cmd/gemin_k8s@latest
````

æˆ–ä» [å‘å¸ƒé¡µé¢](https://github.com/turtacn/geminik8s/releases) ä¸‹è½½é¢„æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚

### å¿«é€Ÿå…¥é—¨

#### 1. åˆå§‹åŒ–åŒèŠ‚ç‚¹é›†ç¾¤é…ç½®

```bash
# åˆ›å»ºé›†ç¾¤é…ç½®
gemin_k8s init --name "my-cluster" \
  --node1-ip "10.10.10.1" \
  --node2-ip "10.10.10.2" \
  --vip "10.10.10.0" \
  --config-dir "./cluster-config"
```

#### 2. éƒ¨ç½²é›†ç¾¤

```bash
# éƒ¨ç½²åˆ°ä¸¤ä¸ªèŠ‚ç‚¹
gemin_k8s deploy --config-dir "./cluster-config" \
  --bootstrap-leader "node1"
```

#### 3. éªŒè¯é›†ç¾¤çŠ¶æ€

```bash
# æ£€æŸ¥é›†ç¾¤å¥åº·çŠ¶å†µ
gemin_k8s status --cluster "my-cluster"

# ç¤ºä¾‹è¾“å‡º:
# é›†ç¾¤: my-cluster
# çŠ¶æ€: å¥åº·
# ä¸»èŠ‚ç‚¹: node1 (10.10.10.1)
# ä»èŠ‚ç‚¹: node2 (10.10.10.2)  
# VIP: 10.10.10.0 (åœ¨ node1 ä¸Šæ´»è·ƒ)
# æ•°æ®åº“: PostgreSQL + Kine (å¤åˆ¶: æ´»è·ƒ)
```

#### 4. é«˜çº§æ“ä½œ

```bash
# è§¦å‘æ‰‹åŠ¨æ•…éšœè½¬ç§»
gemin_k8s failover --cluster "my-cluster" --promote "node2"

# å‡çº§é›†ç¾¤
gemin_k8s upgrade --cluster "my-cluster" \
  --image "my-registry/k8s-image:v1.28.0"

# æ›¿æ¢æ•…éšœèŠ‚ç‚¹
gemin_k8s replace-node --cluster "my-cluster" \
  --old-node "node2" --new-node-ip "10.10.10.3"
```

## ğŸ“– æ–‡æ¡£

* [æ¶æ„æ¦‚è§ˆ](./docs/architecture.md) - è¯¦ç»†çš„ç³»ç»Ÿæ¶æ„å’Œè®¾è®¡å†³ç­–
* [å®‰è£…æŒ‡å—](./docs/installation.md) - å…¨é¢çš„å®‰è£…è¯´æ˜
* [é…ç½®å‚è€ƒ](./docs/configuration.md) - å®Œæ•´çš„é…ç½®é€‰é¡¹
* [æ“ä½œæ‰‹å†Œ](./docs/operations.md) - ç¬¬äºŒå¤©è¿ç»´æŒ‡å—
* [æ•…éšœæ’é™¤](./docs/troubleshooting.md) - å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

## ğŸ¤ è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼geminik8s ç”±ç†è§£ Kubernetes è¿ç»´å®é™…æŒ‘æˆ˜çš„å·¥ç¨‹å¸ˆä»¬ç”¨ â¤ï¸ æ„å»ºã€‚

### è´¡çŒ®æ–¹å¼

* ğŸ› **æŠ¥å‘Šé—®é¢˜**: å‘ç° bugï¼Ÿ[åˆ›å»º issue](https://github.com/turtacn/geminik8s/issues)
* ğŸ’¡ **åŠŸèƒ½è¯·æ±‚**: æœ‰æƒ³æ³•ï¼Ÿæˆ‘ä»¬å¾ˆæƒ³å¬å¬ï¼
* ğŸ”§ **ä»£ç è´¡çŒ®**: ä¸º bug ä¿®å¤æˆ–æ–°åŠŸèƒ½æäº¤ pull request
* ğŸ“ **æ–‡æ¡£**: å¸®åŠ©æ”¹è¿›æˆ‘ä»¬çš„æ–‡æ¡£å’Œç¤ºä¾‹
* ğŸ§ª **æµ‹è¯•**: å¸®åŠ©æˆ‘ä»¬åœ¨ä¸åŒç¯å¢ƒä¸­æµ‹è¯•

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å…‹éš†ä»£ç ä»“åº“
git clone https://github.com/turtacn/geminik8s.git
cd geminik8s

# å®‰è£…ä¾èµ–
go mod tidy

# è¿è¡Œæµ‹è¯•
make test

# æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶
make build
```

è¯¦ç»†è´¡çŒ®æŒ‡å—è¯·å‚è§ [CONTRIBUTING.md](./CONTRIBUTING.md)ã€‚

## ğŸ“œ è®¸å¯è¯

geminik8s é‡‡ç”¨ [Apache License 2.0](LICENSE) è®¸å¯ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥ï¼š

* âœ… å•†ä¸šä½¿ç”¨
* âœ… ä¿®æ”¹å’Œåˆ†å‘
* âœ… ç§äººä½¿ç”¨
* âœ… ä¸“åˆ©ä½¿ç”¨

## ğŸŒŸ ç¤¾åŒºä¸æ”¯æŒ

* ğŸ’¬ **è®¨è®º**: [GitHub è®¨è®ºåŒº](https://github.com/turtacn/geminik8s/discussions)
* ğŸ› **é—®é¢˜**: [Bug æŠ¥å‘Šä¸åŠŸèƒ½è¯·æ±‚](https://github.com/turtacn/geminik8s/issues)
* ğŸ“§ **è”ç³»**: [maintainers@geminik8s.io](mailto:maintainers@geminik8s.io)
* ğŸ”— **ç½‘ç«™**: [https://geminik8s.io](https://geminik8s.io)

---

**ä¸º Kubernetes ç¤¾åŒºç”¨ â¤ï¸ æ„å»º**

*é™ä½æˆæœ¬ä¸åº”è¯¥æ„å‘³ç€åœ¨å¯é æ€§ä¸Šå¦¥åã€‚geminik8s è¯æ˜äº†æ™ºèƒ½æ¶æ„å¯ä»¥å…¼é¡¾ä¸¤è€…ã€‚*